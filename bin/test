#!/bin/sh

EMACS="${EMACS:=emacs}"

cat <<INFO
════════════════════════════════════════════════════════════════════════════════
 _____ _____ ____
| ____|_   _|  _ \\
|  _|   | | | | | |
| |___ _| |_| |_| |
|_____(_)_(_)____(_)

 _____         _
|_   _|__  ___| |_ ___
  | |/ _ \/ __| __/ __|
  | |  __/\__ \ |_\__ \\
  |_|\___||___/\__|___/

════════════════════════════════════════════════════════════════════════════════
$("$EMACS" --version)
════════════════════════════════════════════════════════════════════════════════
INFO

mv etd-examples.el.example etd-examples.el

"$EMACS" --batch \
  -eval "(add-to-list 'load-path \".\")" \
  -l ert \
  -l etd.el \
  -l etd-examples.el \
  --eval "(ert-run-tests-batch-and-exit)"
exitcode=$?

echo "
════════════════════════════════════════════════════════════════════════════════"
exit $exitcode
